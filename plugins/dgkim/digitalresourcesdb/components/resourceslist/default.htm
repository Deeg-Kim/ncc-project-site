<div class="row">
	<div class="col-md-8 offset-md-2">
		<div style="width: 100%; height: 20px;"></div>
		<button style="font-size: 10px; padding: 3px;" class="btn btn-dark translate">日本語で表示</button>
		<div style="width: 100%; height: 5px;"></div>
		<form data-request="onFilter" data-request-update="resourcelist: '#resourceList'">
			<div class="form-group">
				<input type="text" class="form-control" name="search" style="margin-bottom: 10px;" placeholder="Search digital resource database...">
			</div>
			<div class="form-group">
				Search fields: <input type="checkbox" name="searchType[]" value="title" id="check-title" checked> <label class="form-check-label" for="check-title">Resource Title</label>
				<input type="checkbox" name="searchType[]" value="keywords" id="check-keywords" checked> <label class="form-check-label" for="check-keywords">Keywords</label>
				<input type="checkbox" name="searchType[]" value="description" id="check-description"> <label class="form-check-label" for="check-description">Resource Description</label>
			</div>
			<div class="form-group">
				Include category: 
				{% for c in categories %}
				<input type="checkbox" name="categoryFilter[]" value="{{ c.id }}" id="check-{{ c.id }}" checked> <label class="form-check-label" for="check-{{ c.id }}">{{ c.name_english }}</label>
				{% endfor %}
			</div>
			<div class="form-group">
				<button type="submit" class="btn btn-primary">Search</button> <input type="reset" id="reset" value="Clear" class="btn btn-danger">
			</div>
		</form>
		
		<div id="resourceList">
			All resources by romanization: 
			{% if resources|length %}
			<ul class="pagination">
			{% for p in pagination %}
				{% if p.active %}
					<li class="active">
				{% else %}
					<li>
				{% endif %}
						
				{% if p.has %}
					<a href="/?page={{ p.letter }}">
				{% else %}
					<b>
				{% endif %}
						
				{{ p.letter }}
						
				{% if not p.has %}
					</b>
				{% else %}
					</a>
				{% endif %}
						
				{% if p.active %}
					</li>
				{% else %}
					</li>
				{% endif %}
			{% endfor %}
			</ul>
			{% for resource in resources %}
				<div class="card" style="width: 100%; margin: 20px 0 20px 0">
					<div class="card-body">
						<h3 class="card-title"><a href="{{ url('/resource/') }}/{{ resource.id }}">{{ resource.name_japanese }} | {{ resource.name_romanization }}</a></h3>
						<h5 class="card-subtitle mb-2 text-muted">{{ resource.name_english }}</h5>
						{% for category in resource.categories %}
						<span class="badge badge-primary">{{ category.name_english }}</span>
						{% endfor %}
						<p>
							<a href="#" class="card-link">{{ resource.link }}</a> {% if resource.broken %}<a data-trigger="focus" tabindex="0" class="broken badge badge-danger" data-toggle="popover" title="Possibly broken link!" data-content="We've detected that this link may no longer be directing you to a live resource.">!</a>{% endif %}
						</p>
						<p class="card-text">
							<div class="row">
								<div class="col-6" style="border-right: 1px black solid;">{{ resource.description|striptags|length > 200 ? resource.description|striptags|slice(0, 200) ~ '...' : resource.description|striptags }}</div>
								<div class="col-6">{{ resource.description_japanese|striptags|length > 100 ? resource.description_japanese|striptags|slice(0, 100) ~ '...' : resource.description_japanese|striptags }}</div>
							</div>
						</p>
						<p class="card-text"><b>Keywords:</b> {{ resource.keywords }}</p>
					</div>
				</div>
			{% endfor %}
			{% else %}
			<h2 class="text-center">No resources found!</h2>
			{% endif %}
		</div>
	</div>
</div>

{% put styles %}
<style>
	span .btn {
		font-size: 0.8em;
	}
	
	.card-text {
		font-size: 0.9em;
	}
	
	.broken:link {
		color: white;
	}
	
	.broken:hover {
		color: white;
		cursor: pointer;
		text-decoration: none;
	}
	
	.pagination {
		list-style: none;
	}
	
	.pagination li {
		margin: 0 3px;
	}
</style>
{% endput %}

{% put scripts %}
<script>
	$(function () {
		$('.broken').popover({
			trigger: 'focus'
	  	})
		
		$( "#reset" ).click(function() {
			$.request('onFilter', {
				update: {resourcelist: '#resourceList'}
			})
		})
		
		$(".translate").click(function () {
			  $(this).text(function(i, text){
				  return text === "日本語で表示" ? "Display in English" : "日本語で表示";
			  })
	   });
	})
</script>
{% endput %}